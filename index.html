<!DOCTYPE html>
<!--  This site was created in Webflow. http://www.webflow.com  -->
<!--  Last Published: Thu Feb 27 2020 01:18:31 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="5e545902eb54f77ae5e6696f" data-wf-site="5e545902eb54f77d39e6696e">
<head>
  <meta charset="utf-8">
  <title>DefiHedge</title>
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="css/normalize.css" rel="stylesheet" type="text/css">
  <link href="css/webflow.css" rel="stylesheet" type="text/css">
  <link href="css/julios-blank-site-e50fbc.webflow.css" rel="stylesheet" type="text/css">
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="images/webclip.png" rel="apple-touch-icon">
</head>
<body class="body">
  <div class="section">
    <div class="container w-container">
      <div class="bannerblock w-clearfix">
        <div class="useraddress" id="useraddress">0x-------------------------</div>
		<a href ="#" id = "txHash" class="txHash" type="button" onclick="linkTransaction()"><div class="txstatus1" id="txstatus1">Tx:</div></a>
		<div class="useraddresslabel">User Address:</div>
      </div>
      <div class="columns w-row">
        <div class="createcolumn w-col w-col-4 w-col-small-small-stack"><a href="#" data-w-id="75edf02e-6359-ab95-ec3e-c88d6cc5cd95" type="button" onclick="settype(this.innerHTML)" class="ercbutton w-button" id="ETH">ETH</a><a href="#" data-w-id="5870a97d-3094-8531-0793-9982b645efd9" type="button" onclick="settype(this.innerHTML)" class="ercbutton w-button" id="ERC">ERC</a>
          <div class="ratetext">Rate:</div>
          <div class="durationtext">Duration:</div>
          <div class="tokentext">Token:</div>
          <div class="suppliedtext">Supplied:</div>
          <div class="w-form">
            <form id="wf-form-inputForm" name="wf-form-inputForm" data-name="inputForm" class="form">
    <input type="text" class="rate-field w-input" maxlength="256" name="Rate" data-name="Rate" placeholder="e.g. 5, 10, etc.," id="Rate" required="">
    <input type="text" class="text-field w-input" maxlength="256" name="Duration" data-name="Duration" placeholder="Duration (sec)" id="Duration" required="">
    <input type="text" class="token-field w-input" maxlength="256" name="Token" data-name="Token" placeholder="Comp DAI" id="Token" disabled=true>
    <input type="text" class="supplied-field w-input" maxlength="256" name="Supplied" data-name="Supplied" placeholder="# of Tokens" id="Supplied">
    </form>
            <div class="w-form-done">
              <div></div>
            </div>
            <div class="error-message w-form-fail">
              <div></div>
            </div>
          </div><a data-w-id="8f2e2941-366b-9ebc-5ee2-969df2e9f625" type="button" onclick="createoffer()" class="createofferbutton w-button">Create Offer</a>
		  <a href="#" class="authorizebutton1 w-button" type="button" onclick="ercAuthorize('SUPPLY')" id="authorizebutton1">Authorize Token</a></div>
        <div class="offercolumn w-col w-col-4 w-col-small-small-stack">
          <div class="offerdiv">
            <div class="w-layout-grid grid">
              <div id = "activelabel" class="activelabel">Active Offers:</div>
              <div><a href ="#" id = "active1" class="offer1" type="button" onclick="loadcontract(this.innerHTML)"></a></div>
			  <div><a href ="#" id = "active2" class="offer1" type="button" onclick="loadcontract(this.innerHTML)"></a></div>
			  <div><a href ="#" id = "active3" class="offer1" type="button" onclick="loadcontract(this.innerHTML)"></a></div>
			  <div><a href ="#" id = "active4" class="offer1" type="button" onclick="loadcontract(this.innerHTML)"></a></div>
			  <div><a href ="#" id = "active5" class="offer1" type="button" onclick="loadcontract(this.innerHTML)"></a></div>
			  <div><a href ="#" id = "active6" class="offer1" type="button" onclick="loadcontract(this.innerHTML)"></a></div>
			  <div><a href ="#" id = "active7" class="offer1" type="button" onclick="loadcontract(this.innerHTML)"></a></div>
			  <div><a href ="#" id = "active8" class="offer1" type="button" onclick="loadcontract(this.innerHTML)"></a></div>
			  <div><a href ="#" id = "active9" class="offer1" type="button" onclick="loadcontract(this.innerHTML)"></a></div>
            </div>
          </div>
        </div>
        <div class="takecolumn w-col w-col-4 w-col-small-small-stack">
          <div class="div-block-4">
            <div class="selectedoffer" id="selectedoffer">0x-------------------------</div>
          </div>
          <div class="ratetext2">Rate:</div>
          <div class="durationtext2">Duration:</div>
          <div class="tokentext2">Token:</div>
          <div class="suppliedtext2">Supplied:</div>
          <div class="takertext">Taker Stake:</div>
          <div class="stakelabel">
            <div class="contractstake" id ="contractstake"><br>‍</div>
          </div>
          <div class="ratelabel">
            <div class="contractrate" id="contractrate"><br>‍</div>
          </div>
          <div class="durationlabel">
            <div class="contractduration" id="contractduration"><br>‍</div>
          </div>
          <div class="tokenlabel">
            <div class="contractaddress" id="contractaddress"><br>‍</div>
          </div>
          <div class="suppliedlabel">
            <div class="contractsupplied" id="contractsupplied"><br>‍</div>
          </div><a href="#" class="authorizebutton2 w-button" type="button" id= "authorizebutton2" onclick="ercAuthorize('TAKE')">Authorize Token</a>
		  <a data-w-id="01516053-af32-daae-a25d-18c9f4294142" href="#" class="takeofferbutton w-button" id="takeofferbutton" type="button" onclick="takeoffer()">Take Offer</a></div>
      </div><img src="images/LightDefi.png" width="308" alt="" class="image">
      <div class="activecontracts w-clearfix">
        <div class="contractslabel">Active Contracts:</div>
        <div class="contract1" id="contract1">0x-------------------------</div>
        <div class="contractsize1" id="contractsize1">0.00 ETH</div>
        <div class="contractrate1" id="contractrate1">Rate: 0%</div>
		<a href="#" class="releasebutton1 w-button" type="button" onclick="releaseEthContract(1)">Release</a>
		<a href="#" class="releasebutton2 w-button" type="button" onclick="releaseEthContract(2)">Release</a>
		<a href="#" class="releasebutton2-copy w-button" type="button" onclick="releaseEthContract(3)">Release</a>
        <div class="contract2" id="contract2">0x-------------------------</div>
        <div class="contractsize2" id="contractsize2">0.00 ETH</div>
        <div class="contractrate2" id="contractrate2">Rate: 0%</div>
        <div class="contract3" id="contract3">0x-------------------------</div>
        <div class="contractsize3" id="contractsize3">0.00 ETH</div>
        <div class="contractrate3" id="contractrate3">Rate: 0%</div>
		<div class="contractexpire1" id="contractexpire1">01/01/2001 7:00:01 PM</div>
        <div class="contractexpire2" id="contractexpire2">01/01/2001 7:00:01 PM</div>
        <div class="contractexpire3" id="contractexpire3">01/01/2001 7:00:01 PM</div>
      </div>
	  <div class="pocText">
	  On-Chain PoC, deployed on Ropsten
	  </div>
    </div>
  </div>
  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.4.1.min.220afd743d.js" type="text/javascript" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
  <script src="js/webflow.js" type="text/javascript"></script>
  <script src="js/web3.min.js"></script>
<script>
/// Set abi
var offercontractABI = [
	{
		"constant": false,
		"inputs": [
			{
				"name": "rate",
				"type": "uint256"
			},
			{
				"name": "duration",
				"type": "uint256"
			},
			{
				"name": "erc20Contract",
				"type": "address"
			},
			{
				"name": "cEr20Contract",
				"type": "address"
			},
			{
				"name": "tokenNumber",
				"type": "uint256"
			}
		],
		"name": "newErc20Contract",
		"outputs": [
			{
				"name": "newErcContract",
				"type": "address"
			}
		],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [
			{
				"name": "rate",
				"type": "uint256"
			},
			{
				"name": "duration",
				"type": "uint256"
			}
		],
		"name": "newEthContract",
		"outputs": [
			{
				"name": "newEthContract",
				"type": "address"
			}
		],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "constructor"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "contractAddress",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "rate",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "duration",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "newLendEthContract",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "contractAddress",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "rate",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "duration",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "token",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "tokenNumber",
				"type": "uint256"
			}
		],
		"name": "newLendErcContract",
		"type": "event"
	},
	{
		"constant": true,
		"inputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"name": "contracts",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "lastContractAddress",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	}
];
var ethcontractABI = [
	{
		"constant": false,
		"inputs": [],
		"name": "abort",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "bondRelease",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "takeOffer",
		"outputs": [],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"name": "contractOfferer",
				"type": "address"
			},
			{
				"name": "fixRate",
				"type": "uint256"
			},
			{
				"name": "termDuration",
				"type": "uint256"
			}
		],
		"payable": true,
		"stateMutability": "payable",
		"type": "constructor"
	},
	{
		"payable": true,
		"stateMutability": "payable",
		"type": "fallback"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "contractAddress",
				"type": "address"
			}
		],
		"name": "Aborted",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "contractAddress",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "rate",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "lockTime",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "value",
				"type": "uint256"
			}
		],
		"name": "OfferConfirmed",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "contractAddress",
				"type": "address"
			}
		],
		"name": "termEnded",
		"type": "event"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "duration",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "interest",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "lockTime",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "offerer",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "rate",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "state",
		"outputs": [
			{
				"name": "",
				"type": "uint8"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "taker",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "value",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	}
];
var erc20ABI = [
    {
        "constant": true,
        "inputs": [],
        "name": "name",
        "outputs": [
            {
                "name": "",
                "type": "string"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": false,
        "inputs": [
            {
                "name": "_spender",
                "type": "address"
            },
            {
                "name": "_value",
                "type": "uint256"
            }
        ],
        "name": "approve",
        "outputs": [
            {
                "name": "",
                "type": "bool"
            }
        ],
        "payable": false,
        "stateMutability": "nonpayable",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "totalSupply",
        "outputs": [
            {
                "name": "",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": false,
        "inputs": [
            {
                "name": "_from",
                "type": "address"
            },
            {
                "name": "_to",
                "type": "address"
            },
            {
                "name": "_value",
                "type": "uint256"
            }
        ],
        "name": "transferFrom",
        "outputs": [
            {
                "name": "",
                "type": "bool"
            }
        ],
        "payable": false,
        "stateMutability": "nonpayable",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "decimals",
        "outputs": [
            {
                "name": "",
                "type": "uint8"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [
            {
                "name": "_owner",
                "type": "address"
            }
        ],
        "name": "balanceOf",
        "outputs": [
            {
                "name": "balance",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [],
        "name": "symbol",
        "outputs": [
            {
                "name": "",
                "type": "string"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "constant": false,
        "inputs": [
            {
                "name": "_to",
                "type": "address"
            },
            {
                "name": "_value",
                "type": "uint256"
            }
        ],
        "name": "transfer",
        "outputs": [
            {
                "name": "",
                "type": "bool"
            }
        ],
        "payable": false,
        "stateMutability": "nonpayable",
        "type": "function"
    },
    {
        "constant": true,
        "inputs": [
            {
                "name": "_owner",
                "type": "address"
            },
            {
                "name": "_spender",
                "type": "address"
            }
        ],
        "name": "allowance",
        "outputs": [
            {
                "name": "",
                "type": "uint256"
            }
        ],
        "payable": false,
        "stateMutability": "view",
        "type": "function"
    },
    {
        "payable": true,
        "stateMutability": "payable",
        "type": "fallback"
    },
    {
        "anonymous": false,
        "inputs": [
            {
                "indexed": true,
                "name": "owner",
                "type": "address"
            },
            {
                "indexed": true,
                "name": "spender",
                "type": "address"
            },
            {
                "indexed": false,
                "name": "value",
                "type": "uint256"
            }
        ],
        "name": "Approval",
        "type": "event"
    },
    {
        "anonymous": false,
        "inputs": [
            {
                "indexed": true,
                "name": "from",
                "type": "address"
            },
            {
                "indexed": true,
                "name": "to",
                "type": "address"
            },
            {
                "indexed": false,
                "name": "value",
                "type": "uint256"
            }
        ],
        "name": "Transfer",
        "type": "event"
    }
];
var ercContractABI = [
	{
		"constant": false,
		"inputs": [],
		"name": "bondRelease",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "lockTime",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "duration",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "rate",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "abort",
		"outputs": [],
		"payable": false,
		"stateMutability": "nonpayable",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "taker",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "cErc20Contract",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "erc20Contract",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "state",
		"outputs": [
			{
				"name": "",
				"type": "uint8"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "interest",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "offerer",
		"outputs": [
			{
				"name": "",
				"type": "address"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": true,
		"inputs": [],
		"name": "tokenNumber",
		"outputs": [
			{
				"name": "",
				"type": "uint256"
			}
		],
		"payable": false,
		"stateMutability": "view",
		"type": "function"
	},
	{
		"constant": false,
		"inputs": [],
		"name": "takeOffer",
		"outputs": [],
		"payable": true,
		"stateMutability": "payable",
		"type": "function"
	},
	{
		"inputs": [
			{
				"name": "contractOfferer",
				"type": "address"
			},
			{
				"name": "fixRate",
				"type": "uint256"
			},
			{
				"name": "termDuration",
				"type": "uint256"
			},
			{
				"name": "ercContract",
				"type": "address"
			},
			{
				"name": "cErcContract",
				"type": "address"
			},
			{
				"name": "tokenNum",
				"type": "uint256"
			}
		],
		"payable": true,
		"stateMutability": "payable",
		"type": "constructor"
	},
	{
		"payable": true,
		"stateMutability": "payable",
		"type": "fallback"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "contractAddress",
				"type": "address"
			}
		],
		"name": "Aborted",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "contractAddress",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "rate",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "token",
				"type": "address"
			},
			{
				"indexed": false,
				"name": "lockTime",
				"type": "uint256"
			},
			{
				"indexed": false,
				"name": "tokenNumber",
				"type": "uint256"
			}
		],
		"name": "OfferConfirmed",
		"type": "event"
	},
	{
		"anonymous": false,
		"inputs": [
			{
				"indexed": false,
				"name": "contractAddress",
				"type": "address"
			}
		],
		"name": "termEnded",
		"type": "event"
	}
];
function removeDuplicates(originalArray, prop) {
     var newArray = [];
     var lookupObject  = {};

     for(var i in originalArray) {
        lookupObject[originalArray[i][prop]] = originalArray[i];
     }

     for(i in lookupObject) {
         newArray.push(lookupObject[i]);
     }
      return newArray;
 }
 
/// Set token type to ERC or ETH
function settype(type) {
window.tokentype = type;
document.getElementById("Token").placeholder = type;
}
/// take offer for either ERC or ETH

function takeoffer() {
var loadedContractAddress = document.getElementById("selectedoffer").innerHTML;
contractarraylength = window.activeContracts.length;
for (var i = 0; i < contractarraylength; i++) {
if (window.activeContracts[i].contractAddress == loadedContractAddress) {
var loadedContract = activeContracts[i];
var type = loadedContract.type;
if (type == 'ETH') {
takeEthOffer();
}
else if (type == 'DAI'){
takeErcOffer();
}
}
}
}

/// create offer for either ERC or ETH
function createoffer () {
if (window.tokentype == 'ETH') {
createEthOffer()
} else if (window.tokentype == 'ERC')
createErcOffer()
else {
}
}

/// Release bond for either ERC or ETH
function bondRelease(buttonnumber) {
window.releasestatus ='pending';
removeDuplicates(lockedContracts, "contractAddress");
var loadedContractAddress = window.lockedContracts[(buttonnumber-1)].contractAddress;
contractarraylength = window.lockedContracts.length;
for (var i = 0; i < contractarraylength; i++) {
if (window.lockedContracts[i].contractAddress == loadedContractAddress) {
var loadedContract = window.lockedContracts[i];
var type = loadedContract.type;
window.releasestatus ='pending2';
if (type == 'ETH') {
window.releasestatus ='complete';
releaseEthContract(buttonnumber);
}
else if (type == 'DAI'){
releaseErcContract(buttonnumber);
}
}
}
}

///connect to web3 & get default account address
function getAccounts(callback) {
    web3.eth.getAccounts((error,result) => {
        if (error) {
            console.log(error);
        } else {
            callback(result);
        }
    });
}

 // Wait for loading completion to avoid race conditions with web3 injection timing.
  if (window.ethereum) {
      const web3 = new Web3(window.ethereum);
      window.ethereum.enable();}
      account = getAccounts(function(result) {
      document.getElementById("useraddress").innerHTML = result[0];
});

/// Release Eth Funds
function releaseEthContract(buttonnumber) {
var address = window.lockedContracts[(buttonnumber-1)].contractAddress;
var lendEthContract = web3.eth.contract(ethcontractABI).at(address);
var currentaddress = document.getElementById("useraddress").innerHTML;
lendEthContract.bondRelease({  
  from: currentaddress,   
  gas: "200000",   
  value: "",   
  data: "" },  function(error, result){
    if(!error)
		document.getElementById("txstatus1").innerHTML = 'Tx:' + ((JSON.stringify(result)).replace('"',"")).replace('"',"");
    else
        console.error(error);
})
}


/// Release ERC Funds
function releaseErcContract(buttonnumber) {
var address = window.lockedContracts[(buttonnumber-1)].contractAddress;
var lendErcContract = web3.eth.contract(ercContractABI).at();
var currentaddress = document.getElementById("useraddress").innerHTML;
lendEthContract.bondRelease({  
  from: currentaddress,   
  gas: "350000",   
  value: "",   
  data: "" },  function(error, result){
    if(!error)
		document.getElementById("txstatus1").innerHTML = 'Tx:' + ((JSON.stringify(result)).replace('"',"")).replace('"',"");
    else
        console.error(error);
})
}



/// Take an offer for ETH
function takeEthOffer() {
///instantiate contract + take offer
var address = document.getElementById("selectedoffer").innerHTML;
var lendEthContract = web3.eth.contract(ethcontractABI).at(address);
var currentaddress = document.getElementById("useraddress").innerHTML;
var currentstake = Math.ceil(window.currentcontractstake);
lendEthContract.takeOffer({  
  from: currentaddress,   
  gas: "200000",   
  value: currentstake,   
  data: "" },  function(error, result){
    if(!error)
		document.getElementById("txstatus1").innerHTML = 'Tx:' + ((JSON.stringify(result)).replace('"',"")).replace('"',"");
    else
        console.error(error);
})
}

/// Take an offer for ERC
function takeErcOffer() {
///instantiate contract + take offer
var address = document.getElementById("selectedoffer").innerHTML;
var lendErcContract = web3.eth.contract(ercContractABI).at(address);
var currentaddress = document.getElementById("useraddress").innerHTML;
var currentstake = Math.ceil(window.currentcontractstake);
lendErcContract.takeOffer({  
  from: currentaddress,   
  gas: "350000",   
  value: "",   
  data: "" },  function(error, result){
    if(!error)
		document.getElementById("txstatus1").innerHTML = 'Tx:' + ((JSON.stringify(result)).replace('"',"")).replace('"',"");
    else
        console.error(error);
})
}


///creates eth offer with parameters
function createEthOffer() {
///instantiate offercontract, deploy new eth contract using offercontract methods
var address = '0x050075abBE380Db7be02C9250C297Ab476e23fA0';
var offerContract = web3.eth.contract(offercontractABI).at(address);
var currentaddress = document.getElementById("useraddress").value;
var rate = document.getElementById("Rate").value;
var duration = document.getElementById("Duration").value;
var supplied = (Number(document.getElementById("Supplied").value)*1000000000000000000);
offerContract.newEthContract(rate,duration,{  
  from: currentaddress,   
  gas: "700000",   
  value: supplied,   
  data: "" },  function(error, result){
    if(!error)
		document.getElementById("txstatus1").innerHTML = 'Tx:' + ((JSON.stringify(result)).replace('"',"")).replace('"',"");
    else
        console.error(error);
})
}
///creates eth offer with parameters
function createErcOffer() {
///instantiate offercontract, deploy new erc contract using offercontract methods
var address = '0x050075abBE380Db7be02C9250C297Ab476e23fA0';
var offerContract = web3.eth.contract(offercontractABI).at(address);
var currentaddress = document.getElementById("useraddress").value;
var rate = document.getElementById("Rate").value;
var duration = document.getElementById("Duration").value;
var supplied = ((document.getElementById("Supplied").value)*1000000000000000000);
var cerc20address= '0x6ce27497a64fffb5517aa4aee908b1e7eb63b9ff'
var erc20address = '0xb5e5d0f8c0cba267cd3d7035d6adc8eba7df7cdd';
offerContract.newErc20Contract(rate,duration, erc20address, cerc20address, supplied, {  
  from: currentaddress,   
  gas: "900000",   
  value: "",   
  data: "" },  function(error, result){
    if(!error)
		document.getElementById("txstatus1").innerHTML = 'Tx:' + ((JSON.stringify(result)).replace('"',"")).replace('"',"");
    else
        console.error(error);
})
}

/// setup watcher for eth bond release
function setupreleasedeth (watchedaddress) {
var address = watchedaddress;
var lendEthContract = web3.eth.contract(ethcontractABI).at(address);
lendEthContract.termEnded().watch ( (err, response) => {
		var resp = response.args;
		var index  = window.lockedContracts.findIndex(x => x.contractAddress === address);
		if (window.lockedContracts[index].contractAddress == address) {
		window.lockedContracts.splice(index, 1);
		}
		try {document.getElementById("contract1").innerHTML = window.lockedContracts[0].contractAddress;}
		catch (e) {document.getElementById("contract1").innerHTML = "0x-------------------------";}
		try {document.getElementById("contractrate1").innerHTML = 'Rate: ' + window.lockedContracts[0].rate + '%';}
		catch (e) {document.getElementById("contractrate1").innerHTML = "0%";}
		try {
		if (window.lockedContracts[0].type == "DAI") {
		try {document.getElementById("contractsize1").innerHTML = ((window.lockedContracts[0].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {document.getElementById("contractsize1").innerHTML = "0.00 ETH";}
		}
		else if (window.lockedContracts[0].type == "ETH") {
		try {document.getElementById("contractsize1").innerHTML = ((window.lockedContracts[0].value)/1000000000000000000) + ' ETH';}
		catch (e) {document.getElementById("contractsize1").innerHTML = "0.00 ETH";}
		}
		else {document.getElementById("contractsize1").innerHTML = "0.00 ETH";}
		}
		catch (e) {document.getElementById("contractsize1").innerHTML = "0.00 ETH";}
		try {
		var lockTime = window.lockedContracts[0].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire1").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {document.getElementById("contractexpire1").innerHTML = "01/01/2001 7:00:01 PM";}
		try {document.getElementById("contract2").innerHTML = window.lockedContracts[1].contractAddress;}
		catch (e) {document.getElementById("contract2").innerHTML = "0x-------------------------";}
		try {document.getElementById("contractrate2").innerHTML = 'Rate: ' + window.lockedContracts[1].rate + '%';}
		catch (e) {document.getElementById("contractrate2").innerHTML = "0%";}
		try {
		if (window.lockedContracts[1].type == "DAI") {
		try {document.getElementById("contractsize2").innerHTML = ((window.lockedContracts[1].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {document.getElementById("contractsize2").innerHTML = "0.00 ETH";}
		}
		else if (window.lockedContracts[1].type == "ETH") {
		try {document.getElementById("contractsize2").innerHTML = ((window.lockedContracts[1].value)/1000000000000000000) + ' ETH';}
		catch (e) {document.getElementById("contractsize2").innerHTML = "0.00 ETH";}
		}
		else {document.getElementById("contractsize2").innerHTML = "0.00 ETH";}
		}
		catch (e) {document.getElementById("contractsize2").innerHTML = "0.00 ETH";}
		try {
		var lockTime = window.lockedContracts[1].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire2").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {document.getElementById("contractexpire2").innerHTML = "01/01/2001 7:00:01 PM";}
		try {document.getElementById("contract3").innerHTML = window.lockedContracts[2].contractAddress;}
		catch (e) {document.getElementById("contract3").innerHTML = "0x-------------------------";}
		try {document.getElementById("contractrate3").innerHTML = 'Rate: ' + window.lockedContracts[2].rate; + '%'}
		catch (e) {document.getElementById("contractrate3").innerHTML = "0%";}
		try {
		if (window.lockedContracts[2].type == "DAI") {
		try {document.getElementById("contractsize3").innerHTML = ((window.lockedContracts[2].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {document.getElementById("contractsize3").innerHTML = "0.00 ETH";}
		}
		else if (window.lockedContracts[2].type == "ETH") {
		try {document.getElementById("contractsize3").innerHTML = ((window.lockedContracts[2].value)/1000000000000000000) + ' ETH';}
		catch (e) {document.getElementById("contractsize3").innerHTML = "0.00 ETH";}
		}
		else {document.getElementById("contractsize3").innerHTML = "0.00 ETH";}
		}
		catch (e) {document.getElementById("contractsize3").innerHTML = "0.00 ETH";}
		try {
		var lockTime = window.lockedContracts[2].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire3").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {document.getElementById("contractexpire3").innerHTML = "01/01/2001 7:00:01 PM";}
		});
		}
		
/// setup watcher for eth bond release
function setupreleasederc (watchedaddress) {
var address = watchedaddress;
var lendErcContract = web3.eth.contract(ercContractABI).at(address);
lendErcContract.termEnded().watch ( (err, response) => {
		var resp = response.args;
		var index  = window.lockedContracts.findIndex(x => x.contractAddress === address);
		if (window.lockedContracts[index].contractAddress == address) {
		window.lockedContracts.splice(index, 1);
		}
		try {document.getElementById("contract1").innerHTML = window.lockedContracts[0].contractAddress;}
		catch (e) {document.getElementById("contract1").innerHTML = "0x-------------------------";}
		try {document.getElementById("contractrate1").innerHTML = 'Rate: ' + window.lockedContracts[0].rate + '%';}
		catch (e) {document.getElementById("contractrate1").innerHTML = "0%";}
		try {
		if (window.lockedContracts[0].type == "DAI") {
		try {document.getElementById("contractsize1").innerHTML = ((window.lockedContracts[0].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {document.getElementById("contractsize1").innerHTML = "0.00 ETH";}
		}
		else if (window.lockedContracts[0].type == "ETH") {
		try {document.getElementById("contractsize1").innerHTML = ((window.lockedContracts[0].value)/1000000000000000000) + ' ETH';}
		catch (e) {document.getElementById("contractsize1").innerHTML = "0.00 ETH";}
		}
		else {document.getElementById("contractsize1").innerHTML = "0.00 ETH";}
		}
		catch (e) {document.getElementById("contractsize1").innerHTML = "0.00 ETH";}
		try {
		var lockTime = window.lockedContracts[0].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire1").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {document.getElementById("contractexpire1").innerHTML = "01/01/2001 7:00:01 PM";}
		try {document.getElementById("contract2").innerHTML = window.lockedContracts[1].contractAddress;}
		catch (e) {document.getElementById("contract2").innerHTML = "0x-------------------------";}
		try {document.getElementById("contractrate2").innerHTML = 'Rate: ' + window.lockedContracts[1].rate + '%';}
		catch (e) {document.getElementById("contractrate2").innerHTML = "0%";}
		try {
		if (window.lockedContracts[1].type == "DAI") {
		try {document.getElementById("contractsize2").innerHTML = ((window.lockedContracts[1].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {document.getElementById("contractsize2").innerHTML = "0.00 ETH";}
		}
		else if (window.lockedContracts[1].type == "ETH") {
		try {document.getElementById("contractsize2").innerHTML = ((window.lockedContracts[1].value)/1000000000000000000) + ' ETH';}
		catch (e) {document.getElementById("contractsize2").innerHTML = "0.00 ETH";}
		}
		else {document.getElementById("contractsize2").innerHTML = "0.00 ETH";}
		}
		catch (e) {document.getElementById("contractsize2").innerHTML = "0.00 ETH";}
		try {
		var lockTime = window.lockedContracts[1].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire2").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {document.getElementById("contractexpire2").innerHTML = "01/01/2001 7:00:01 PM";}
		try {document.getElementById("contract3").innerHTML = window.lockedContracts[2].contractAddress;}
		catch (e) {document.getElementById("contract3").innerHTML = "0x-------------------------";}
		try {document.getElementById("contractrate3").innerHTML = 'Rate: ' + window.lockedContracts[2].rate + '%';}
		catch (e) {document.getElementById("contractrate3").innerHTML = "0%";}
		try {
		if (window.lockedContracts[2].type == "DAI") {
		try {document.getElementById("contractsize3").innerHTML = ((window.lockedContracts[2].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {document.getElementById("contractsize3").innerHTML = "0.00 ETH";}
		}
		else if (window.lockedContracts[2].type == "ETH") {
		try {document.getElementById("contractsize3").innerHTML = ((window.lockedContracts[2].value)/1000000000000000000) + ' ETH';}
		catch (e) {document.getElementById("contractsize3").innerHTML = "0.00 ETH";}
		}
		else {document.getElementById("contractsize3").innerHTML = "0.00 ETH";}
		}
		catch (e) {document.getElementById("contractsize3").innerHTML = "0.00 ETH";}
		try {
		var lockTime = window.lockedContracts[2].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire3").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {document.getElementById("contractexpire3").innerHTML = "01/01/2001 7:00:01 PM";}
		});
		}
		
		
/// listen for eth contract abort
function setupabortethwatcher(watchedaddress){
var address = watchedaddress;
var lendEthContract = web3.eth.contract(ethcontractABI).at(address);
lendEthContract.Aborted().watch ( (err, response) => {
		var resp = response.args;
		var index  = window.activeContracts.findIndex(x => x.contractAddress === address);
		if (window.activeContracts[index].contractAddress == address) {
		window.activeContracts.splice(index, 1);
		}
		else {}
		try {document.getElementById("active1").innerHTML = activeContracts[0].contractAddress;}
		catch (e) {document.getElementById("active1").innerHTML = ""}
		try {document.getElementById("active2").innerHTML = activeContracts[1].contractAddress;}
		catch (e) {document.getElementById("active2").innerHTML = ""}
		try {document.getElementById("active3").innerHTML = activeContracts[2].contractAddress;}
		catch (e) {document.getElementById("active3").innerHTML = ""}
		try {document.getElementById("active4").innerHTML = activeContracts[3].contractAddress;}
		catch (e) {document.getElementById("active4").innerHTML = ""}
		try {document.getElementById("active5").innerHTML = activeContracts[4].contractAddress;}
		catch (e) {document.getElementById("active5").innerHTML = ""}
		try {document.getElementById("active6").innerHTML = activeContracts[5].contractAddress;}
		catch (e) {document.getElementById("active6").innerHTML = ""}
		try {document.getElementById("active7").innerHTML = activeContracts[6].contractAddress;}
		catch (e) {document.getElementById("active7").innerHTML = ""}
		try {document.getElementById("active8").innerHTML = activeContracts[7].contractAddress;}
		catch (e) {document.getElementById("active8").innerHTML = ""}
		});
		}
/// listen for erc contract abort
function setupabortercwatcher(watchedaddress){
var address = watchedaddress;
var lendErcContract = web3.eth.contract(ercContractABI).at(address);
lendErcContract.Aborted().watch ( (err, response) => {
		var resp = response.args;
		var index  = window.activeContracts.findIndex(x => x.contractAddress === address);
		if (window.activeContracts[index].contractAddress == address) {
		window.activeContracts.splice(index, 1);
		}
		else {}
		try {document.getElementById("active1").innerHTML = activeContracts[0].contractAddress;}
		catch (e) {document.getElementById("active1").innerHTML = ""}
		try {document.getElementById("active2").innerHTML = activeContracts[1].contractAddress;}
		catch (e) {document.getElementById("active2").innerHTML = ""}
		try {document.getElementById("active3").innerHTML = activeContracts[2].contractAddress;}
		catch (e) {document.getElementById("active3").innerHTML = ""}
		try {document.getElementById("active4").innerHTML = activeContracts[3].contractAddress;}
		catch (e) {document.getElementById("active4").innerHTML = ""}
		try {document.getElementById("active5").innerHTML = activeContracts[4].contractAddress;}
		catch (e) {document.getElementById("active5").innerHTML = ""}
		try {document.getElementById("active6").innerHTML = activeContracts[5].contractAddress;}
		catch (e) {document.getElementById("active6").innerHTML = ""}
		try {document.getElementById("active7").innerHTML = activeContracts[6].contractAddress;}
		catch (e) {document.getElementById("active7").innerHTML = ""}
		try {document.getElementById("active8").innerHTML = activeContracts[7].contractAddress;}
		catch (e) {document.getElementById("active8").innerHTML = ""}
		});
		}

///listen for eth contract activations
function setuplockedethwatcher(watchedaddress) {
var address = watchedaddress;
var lendEthContract = web3.eth.contract(ethcontractABI).at(address);
lendEthContract.OfferConfirmed().watch ( (err, response) => {
		window.recentethcontract = response.args;
		var index = lockedContracts.findIndex(x => x.contractAddress==window.recentethcontract.contractAddress)

	    if (index === -1){
		var index2  = window.activeContracts.findIndex(x => x.contractAddress === address);
		window.recentethcontract.type = window.activeContracts[index2].type;
		window.lockedContracts.push(window.recentethcontract);
		}
		else console.log("object already exists")
		var index  = window.activeContracts.findIndex(x => x.contractAddress === address);
		if (window.activeContracts[index].contractAddress == address) {
		window.activeContracts.splice(index, 1);
		try {document.getElementById("active1").innerHTML = activeContracts[0].contractAddress;}
		catch (e) {document.getElementById("active1").innerHTML = "";}
		try {document.getElementById("active2").innerHTML = activeContracts[1].contractAddress;}
		catch (e) {document.getElementById("active2").innerHTML = "";}
		try {document.getElementById("active3").innerHTML = activeContracts[2].contractAddress;}
		catch (e) {document.getElementById("active3").innerHTML = "";}
		try {document.getElementById("active4").innerHTML = activeContracts[3].contractAddress;}
		catch (e) {document.getElementById("active4").innerHTML = "";}
		try {document.getElementById("active5").innerHTML = activeContracts[4].contractAddress;}
		catch (e) {document.getElementById("active5").innerHTML = "";}
		try {document.getElementById("active6").innerHTML = activeContracts[5].contractAddress;}
		catch (e) {document.getElementById("active6").innerHTML = "";}
		try {document.getElementById("active7").innerHTML = activeContracts[6].contractAddress;}
		catch (e) {document.getElementById("active7").innerHTML = "";}
		try {document.getElementById("active8").innerHTML = activeContracts[7].contractAddress;}
		catch (e) {document.getElementById("active8").innerHTML = "";}
		}
		setupreleasedeth(address);
		try {document.getElementById("contract1").innerHTML = window.lockedContracts[0].contractAddress;}
		catch (e) {}
		try {document.getElementById("contractrate1").innerHTML = 'Rate: ' + window.lockedContracts[0].rate + '%';}
		catch (e) {}
		if (window.lockedContracts[0].type == "DAI") {
		try {document.getElementById("contractsize1").innerHTML = ((window.lockedContracts[0].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {}
		}
		else {}
		if (window.lockedContracts[0].type == "ETH") {
		try {document.getElementById("contractsize1").innerHTML = ((window.lockedContracts[0].value)/1000000000000000000) + ' ETH';}
		catch (e) {}
		}
		try {
		var lockTime = window.lockedContracts[0].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire1").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {}
		try {document.getElementById("contract2").innerHTML = window.lockedContracts[1].contractAddress;}
		catch (e) {}
		try {document.getElementById("contractrate2").innerHTML = 'Rate: ' + window.lockedContracts[1].rate + '%';}
		catch (e) {}
		if (window.lockedContracts[1].type == "DAI") {
		try {document.getElementById("contractsize2").innerHTML = ((window.lockedContracts[1].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {}
		}
		if (window.lockedContracts[1].type == "ETH") {
		try {document.getElementById("contractsize2").innerHTML = ((window.lockedContracts[1].value)/1000000000000000000) + ' ETH';}
		catch (e) {}
		}
		try {
		var lockTime = window.lockedContracts[1].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire2").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {}
		try {document.getElementById("contract3").innerHTML = window.lockedContracts[2].contractAddress;}
		catch (e) {}
		try {document.getElementById("contractrate3").innerHTML = 'Rate: ' + window.lockedContracts[2].rate + '%';}
		catch (e) {}
		if (window.lockedContracts[2].type == "DAI") {
		try {document.getElementById("contractsize3").innerHTML = ((window.lockedContracts[2].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {}
		}
		if (window.lockedContracts[2].type == "ETH") {
		try {document.getElementById("contractsize3").innerHTML = ((window.lockedContracts[2].value)/1000000000000000000) + ' ETH';}
		catch (e) {}
		}
		try {
		var lockTime = window.lockedContracts[2].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire3").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {}
		});
		}
/// listen for erc contract activations
function setuplockedercwatcher(watchedaddress) {
var address = watchedaddress;
var lendErcContract = web3.eth.contract(ercContractABI).at(address);
lendErcContract.OfferConfirmed().watch ( (err, response) => {
		window.recenterccontract = response.args;
		var index = lockedContracts.findIndex(x => x.contractAddress==window.recenterccontract.contractAddress)

	    if (index === -1){
		var index2  = window.activeContracts.findIndex(x => x.contractAddress === address);
		window.recenterccontract.type = window.activeContracts[index2].type;
		window.lockedContracts.push(window.recenterccontract);
		}
		else console.log("object already exists");
		var index  = window.activeContracts.findIndex(x => x.contractAddress === address);
		if (window.activeContracts[index].contractAddress == address) {
		window.activeContracts.splice(index, 1);
		try {document.getElementById("active1").innerHTML = activeContracts[0].contractAddress;}
		catch (e) {document.getElementById("active1").innerHTML = "";}
		try {document.getElementById("active2").innerHTML = activeContracts[1].contractAddress;}
		catch (e) {document.getElementById("active2").innerHTML = "";}
		try {document.getElementById("active3").innerHTML = activeContracts[2].contractAddress;}
		catch (e) {document.getElementById("active3").innerHTML = "";}
		try {document.getElementById("active4").innerHTML = activeContracts[3].contractAddress;}
		catch (e) {document.getElementById("active4").innerHTML = "";}
		try {document.getElementById("active5").innerHTML = activeContracts[4].contractAddress;}
		catch (e) {document.getElementById("active5").innerHTML = "";}
		try {document.getElementById("active6").innerHTML = activeContracts[5].contractAddress;}
		catch (e) {document.getElementById("active6").innerHTML = "";}
		try {document.getElementById("active7").innerHTML = activeContracts[6].contractAddress;}
		catch (e) {document.getElementById("active7").innerHTML = "";}
		try {document.getElementById("active8").innerHTML = activeContracts[7].contractAddress;}
		catch (e) {document.getElementById("active8").innerHTML = "";}
		}
		setupreleasederc(address);
		try {document.getElementById("contract1").innerHTML = window.lockedContracts[0].contractAddress;}
		catch (e) {}
		try {document.getElementById("contractrate1").innerHTML = 'Rate: ' + window.lockedContracts[0].rate + '%';}
		catch (e) {}
		if (window.lockedContracts[0].type == "DAI") {
		try {document.getElementById("contractsize1").innerHTML = ((window.lockedContracts[0].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {}
		}
		if (window.lockedContracts[0].type == "ETH") {
		try {document.getElementById("contractsize1").innerHTML = ((window.lockedContracts[0].value)/1000000000000000000) + ' ETH';}
		catch (e) {}
		}
		try {
		var lockTime = window.lockedContracts[0].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire1").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {}
		try {document.getElementById("contract2").innerHTML = window.lockedContracts[1].contractAddress;}
		catch (e) {}
		try {document.getElementById("contractrate2").innerHTML = 'Rate: ' + window.lockedContracts[1].rate + '%';}
		catch (e) {}
		if (window.lockedContracts[1].type == "DAI") {
		try {document.getElementById("contractsize2").innerHTML = ((window.lockedContracts[1].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {}
		}
		if (window.lockedContracts[1].type == "ETH") {
		try {document.getElementById("contractsize2").innerHTML = ((window.lockedContracts[1].value)/1000000000000000000) + ' ETH';}
		catch (e) {}
		}
		try {
		var lockTime = window.lockedContracts[1].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire2").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {}
		try {document.getElementById("contract3").innerHTML = window.lockedContracts[2].contractAddress;}
		catch (e) {}
		try {document.getElementById("contractrate3").innerHTML = 'Rate: ' + window.lockedContracts[2].rate + '%';}
		catch (e) {}
		if (window.lockedContracts[2].type == "DAI") {
		try {document.getElementById("contractsize3").innerHTML = ((window.lockedContracts[2].tokenNumber)/1000000000000000000) + ' DAI';}
		catch (e) {}
		}
		if (window.lockedContracts[2].type == "ETH") {
		try {document.getElementById("contractsize3").innerHTML = ((window.lockedContracts[2].value)/1000000000000000000) + ' ETH';}
		catch (e) {}
		}
		try {
		var lockTime = window.lockedContracts[2].lockTime;
		var convertedTime = new Date(lockTime *1000);
		document.getElementById("contractexpire3").innerHTML = convertedTime.toLocaleString();
		}
		catch (e) {}
		});
		}
		
///listen for new contract creations 
var offercontractaddress = '0x050075abBE380Db7be02C9250C297Ab476e23fA0';
var offerContract = web3.eth.contract(offercontractABI).at(offercontractaddress);
window.activeContracts = [];
window.lockedContracts = [];
var i = 0;
///listen for Eth contracts

offerContract.newLendEthContract().watch ( (err, response) => {
		window.recentethcontract = response.args;
		window.recentethcontract.type = 'ETH';
		var index = activeContracts.findIndex(x => x.contractAddress==window.recentethcontract.contractAddress)

	    if (index === -1){
		window.activeContracts.push(window.recentethcontract);
		}
		else console.log("object already exists");
		setuplockedethwatcher(recentethcontract.contractAddress);
		setupabortethwatcher(recentethcontract.contractAddress);
		window.watchercount = i+1;
		removeDuplicates(window.activeContracts, "contractAddress");
		try {document.getElementById("active1").innerHTML = activeContracts[0].contractAddress;}
		catch (e) {}
		try {document.getElementById("active2").innerHTML = activeContracts[1].contractAddress;}
		catch (e) {}
		try {document.getElementById("active3").innerHTML = activeContracts[2].contractAddress;}
		catch (e) {}
		try {document.getElementById("active4").innerHTML = activeContracts[3].contractAddress;}
		catch (e) {}
		try {document.getElementById("active5").innerHTML = activeContracts[4].contractAddress;}
		catch (e) {}
		try {document.getElementById("active6").innerHTML = activeContracts[5].contractAddress;}
		catch (e) {}
		try {document.getElementById("active7").innerHTML = activeContracts[6].contractAddress;}
		catch (e) {}
		try {document.getElementById("active8").innerHTML = activeContracts[7].contractAddress;}
		catch (e) {}
		});

///listen for Erc contracts
offerContract.newLendErcContract().watch ( (err, response) => {
		window.recenterccontract = response.args;
		window.recenterccontract.type = 'DAI';
		var index = activeContracts.findIndex(x => x.contractAddress==window.recenterccontract.contractAddress)

	    if (index === -1){
		window.activeContracts.push(window.recenterccontract);
		}
		else console.log("object already exists");
		setuplockedercwatcher(recenterccontract.contractAddress);
		setupabortercwatcher(recenterccontract.contractAddress);
		try {document.getElementById("active1").innerHTML = activeContracts[0].contractAddress;}
		catch (e) {}
		try {document.getElementById("active2").innerHTML = activeContracts[1].contractAddress;}
		catch (e) {}
		try {document.getElementById("active3").innerHTML = activeContracts[2].contractAddress;}
		catch (e) {}
		try {document.getElementById("active4").innerHTML = activeContracts[3].contractAddress;}
		catch (e) {}
		try {document.getElementById("active5").innerHTML = activeContracts[4].contractAddress;}
		catch (e) {}
		try {document.getElementById("active6").innerHTML = activeContracts[5].contractAddress;}
		catch (e) {}
		try {document.getElementById("active7").innerHTML = activeContracts[6].contractAddress;}
		catch (e) {}
		try {document.getElementById("active8").innerHTML = activeContracts[7].contractAddress;}
		catch (e) {}
		});

/// load offer when address is selected
function loadcontract(loadedContractAddress) {
contractarraylength = window.activeContracts.length;
for (var i = 0; i < contractarraylength; i++) {
if (window.activeContracts[i].contractAddress == loadedContractAddress) {
var loadedContract = activeContracts[i];
var type = loadedContract.type;
if (type == 'ETH'){
document.getElementById("contractaddress").innerHTML = type;
window.currentcontractstake = Number((((loadedContract.value/31622400)*loadedContract.duration)*(loadedContract.rate/100))+1100000000000)
document.getElementById("selectedoffer").innerHTML = loadedContract.contractAddress;  
document.getElementById("contractrate").innerHTML = loadedContract.rate + ' ' + '% APR';  
document.getElementById("contractduration").innerHTML = loadedContract.duration + ' ' + '(Sec)';  
document.getElementById("contractsupplied").innerHTML = ((loadedContract.value)/1000000000000000000) + ' ' + 'ETH';  
document.getElementById("contractstake").innerHTML = (((((loadedContract.value)/1000000000000000000)/31622400)*loadedContract.duration)*(loadedContract.rate/100)).toFixed(6) + ' ' + 'ETH'
}
else if (type == 'DAI'){
document.getElementById("contractaddress").innerHTML = type;
window.currentcontractstake = Number((((loadedContract.value/31622400)*loadedContract.duration)*(loadedContract.rate/100))+1100000000000)
document.getElementById("selectedoffer").innerHTML = loadedContract.contractAddress;  
document.getElementById("contractrate").innerHTML = loadedContract.rate + ' ' + '% APR';  
document.getElementById("contractduration").innerHTML = loadedContract.duration + ' ' + '(Sec)';  
document.getElementById("contractsupplied").innerHTML = ((loadedContract.tokenNumber)/1000000000000000000) + ' ' + 'DAI';  
document.getElementById("contractstake").innerHTML = (((((loadedContract.tokenNumber)/1000000000000000000)/31622400)*loadedContract.duration)*(loadedContract.rate/100)).toFixed(6) + ' ' + 'DAI'
}
else {}
}
}
}
/// Authorize ERC contract deposit
function ercAuthorize (type) {
window.tokentype = type;
if (type == 'SUPPLY'){
var tokenaddress = '0xB5E5D0F8C0cbA267CD3D7035d6AdC8eBA7Df7Cdd';
var tokencontract = web3.eth.contract(erc20ABI).at(tokenaddress);
var currentaddress = document.getElementById("useraddress").innerHTML;
tokencontract.approve('0x050075abBE380Db7be02C9250C297Ab476e23fA0', '1000000000000000000000000000000', function (error, result) {console.log(result)});
}
else if (type == 'TAKE'){
var tokenaddress = '0xB5E5D0F8C0cbA267CD3D7035d6AdC8eBA7Df7Cdd'
var tokencontract = web3.eth.contract(erc20ABI).at(tokenaddress);
var currentaddress = document.getElementById("useraddress").innerHTML;
var currentcontractaddress = document.getElementById("selectedoffer").innerHTML;
tokencontract.approve(currentcontractaddress, '1000000000000000000000000000000', function (error, result) {console.log(result)});
}
}

/// link txid
function linkTransaction() {
	txid = document.getElementById('txstatus1').innerText.split(":");
	txidfix = txid[1].replace('"',"");
	url = "https://ropsten.etherscan.io/tx/".concat(txidfix);
	window.open(url);
}


/// check for metamask address changes
var account = web3.eth.accounts[0];
var accountInterval = setInterval(function() {
if (window.ethereum.chainId == "0x3") {
	if (web3.eth.accounts[0] !== account) {
		account = web3.eth.accounts[0];
		document.getElementById("useraddress").innerHTML = account;
	  }
	}
else {
document.getElementById("useraddress").innerHTML = "Wrong Ethereum Network"
}
}, 100);
    </script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>
</html>